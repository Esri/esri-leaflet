<!DOCTYPE html>
<html>
	<head>
		<title>ArcGIS Basemaps</title>
    	<link rel="stylesheet" href="../vendor/leaflet/dist/leaflet.css" />    
    	<link rel="stylesheet" href="../src/esri-leaflet.css" />        
   		<script src="geoservices.js"></script> 
    	<script src="../vendor/leaflet/dist/leaflet-src.js"></script>
    	<script src="../dist/esri-leaflet.min.js"></script>
		<style>
			html, body, #map {
				width: 100%;
				height: 100%;
				margin: 0;
				font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
				font-size: 12px;
			}
			.control-container {
				text-align: center;
				margin: 10px;
			}
			.title {
				margin: 10px 0 5px 0;
				padding: 2px 10px;
				font-size: 15px;
				background-color: #b0de5c;
			}
			.btn {
				width: 125px;
				margin: 5px 5px 0px 5px;
			}
        
		</style>
	</head>
	<body>
		<div id="map"> </div>

		<script> 
		
			//Global Variable for storing when the click happened for the identify
			var mapClickEventResult;
			
			//Initializing the map to start at the east coast
			var map = L.map('map').setView([42, -74], 5);
			
			//Add Oceans Basemaps
			L.esri.basemapLayer("Oceans").addTo(map);

					
			//ArcGIS Server Dynamic Map Service, Historic Hurricane Tracks		
			dynLayer = L.esri.dynamicMapLayer("http://tmservices1.esri.com/arcgis/rest/services/LiveFeeds/Hurricane_Recent/MapServer", {
				opacity : 1,
  				layers:[0,1],
					});
								
			map.addLayer(dynLayer);
									
			//Identifying Dynamic Map Service Features
			map.on("click", function(e) {
				mapClickEventResult = e;
				
				dynLayer.identify(e.latlng, function(data) {
					if(data.results.length > 0)
					{
						//Popup text should be in html format.  Showing the Storm Name with the type
						popupText =  "<center><b>" + data.results[0].attributes.STORMNAME + "</b><br>" + data.results[0].attributes.STORMTYPE + "</center>";
						
						//Add Popup to the map when the mouse was clicked at
						var popup = L.popup()
					    .setLatLng(mapClickEventResult.latlng)
					    .setContent(popupText)
					    .openOn(map);
					}
				});
			
			});
			
		 </script> 

	</body>
</html>