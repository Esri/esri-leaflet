<!DOCTYPE html>
<!--[if lt IE 7 ]> <html class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="not-ie"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  
    <title>L.esri.Query | Esri Leaflet</title>
  

  
    <meta name="description" content="A lightweight set of tools for using ArcGIS services with Leaflet.">
  

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--[if lt IE 9]>
    <script src="//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv-printshiv.js"></script>
  <![endif]-->

  <!-- google fonts -->
  <link href="//fonts.googleapis.com/css?family=Vollkorn:400italic,700italic,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Source+Code+Pro:300">
  <link href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

  <!-- stylesheet -->
  <link rel="stylesheet" href="../../css/style.css">

  

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>

  
    <script src="https://unpkg.com/esri-leaflet@3.0.7/dist/esri-leaflet.js"
      integrity="sha512-ciMHuVIB6ijbjTyEdmy1lfLtBwt0tEHZGhKVXDzW7v7hXOe+Fo3UA1zfydjCLZ0/vLacHkwSARXB5DmtNaoL/g=="
      crossorigin=""></script>
  

  

  

  

  
</head>
<body>
  <div class="page-content ">
    <div class="container">
      <span id="mobileMenuButton" class="mobileMenuButton">&#9776;</span>
      <a class="site-nav" href="../../" class="left logo">Esri Leaflet</a>
      <nav id="site-nav-wrapper" class="site-nav-wrapper">
        <a class="site-nav" href="../../tutorials/">Tutorials</a>
        <a class="site-nav" href="../../examples/">Examples</a>
        <a class="site-nav" href="../../api-reference/">API Reference</a>
        <a class="site-nav" href="../../plugins/">Plugins</a>
        <a class="site-nav" href="../../download/">Download</a>
        <a class="site-nav" href="https://github.com/Esri/esri-leaflet">View on GitHub</a>
      </nav>
    </div>
    <div id="background-map" class="background-map"></div>

  

<div class="container white">
  

<aside class="sidebar">
  <h5>Layers</h5>
  <nav>
    <a class="plugin" href="../../api-reference/layers/vector-basemap.html">Vector Basemap Layer</a>
    <a class="plugin" href="../../api-reference/layers/cluster-feature-layer.html">Cluster Feature Layer</a>
    <a href="../../api-reference/layers/dynamic-map-layer.html">Dynamic Map Layer</a>
    <a href="../../api-reference/layers/feature-layer.html">Feature Layer</a>
    <a class="plugin" href="../../api-reference/layers/heatmap-feature-layer.html">Heatmap Feature Layer</a>
    <a href="../../api-reference/layers/image-map-layer.html">Image Map Layer</a>
    <a href="../../api-reference/layers/tiled-map-layer.html">Tiled Map Layer</a>
    <a class="plugin" href="../../api-reference/layers/vector-layer.html">Vector Layer</a>
  </nav>

  <h5>Controls</h5>
  <nav>
    <a class="plugin" href="../../api-reference/controls/geosearch.html" class="plugin">Geosearch</a>
  </nav>

  <h5>Tasks</h5>
  <nav>
    <a href="../../api-reference/tasks/find.html">Find</a>
    <a class="plugin" href="../../api-reference/tasks/geocode.html">Geocode</a>
    <a class="plugin" href="../../api-reference/tasks/reverse-geocode.html">Reverse Geocode</a>
    <a class="plugin" href="../../api-reference/tasks/suggest.html">Suggest</a>
    <a class="plugin" href="../../api-reference/tasks/gp.html">Geoprocessing Task</a>
    <a href="../../api-reference/tasks/identify-features.html">Identify Features</a>
    <a href="../../api-reference/tasks/identify-image.html">Identify Image</a>
    <a href="../../api-reference/tasks/query.html">Query</a>
    <a class="plugin" href="../../api-reference/tasks/query-related.html">Query Related</a>
  </nav>

  <h5>Misc.</h5>
  <nav>
    <a href="../../api-reference/events.html">Events</a>
    <a href="../../api-reference/options.html">options</a>
    <a href="../../api-reference/request.html">request</a>
    <a href="../../api-reference/util.html">Util</a>
  </nav>

  <h5>Base Classes</h5>
  <nav>
    <a href="../../api-reference/services/feature-layer-service.html">FeatureLayerService</a>
    <a class="plugin" href="../../api-reference/services/geocode-service.html">Geocode Service</a>
    <a class="plugin" href="../../api-reference/services/gp-service.html">Geoprocessing Service</a>
    <a href="../../api-reference/services/image-service.html">ImageService</a>
    <a href="../../api-reference/services/map-service.html">MapService</a>
    <a href="../../api-reference/layers/raster-layer.html">Raster Layer</a>
    <a href="../../api-reference/services/service.html">Service</a>
    <a href="../../api-reference/tasks/task.html">Task</a>
  </nav>

  <h5>Deprecated</h5>
  <nav>
    <a class="deprecated" href="../../api-reference/layers/basemap-layer.html">Basemap Layer</a>
  </nav>

</aside>


<div class="main-content">
  <h1 id="l-esri-query">L.esri.Query</h1>
<p>Extends <a href="../../api-reference/tasks/task.html"><code>L.esri.Task</code></a></p>
<p><code>L.esri.Query</code> is an abstraction for the query API included in Feature Layers and Image Services. It provides a chainable API for building request parameters and executing queries.</p>
<p><strong>Note</strong> Depending on the type of service you are querying (Feature Layer, Map Service, Image Service) and the version of ArcGIS Server that hosts the service some of these options may not be available.</p>
<h3 id="constructor">Constructor</h3>
<table>
    <thead>
        <tr>
            <th>Constructor</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            <code>L.esri.query(<span>&lt;Object&gt;</span> <code>options</code>)</code><br><br>
            <code>L.esri.query(<span>&lt;<a href="../../api-reference/services/feature-layer-service.html">FeatureLayerService</a>&gt;</span> <code>endpoint</code>)</code><br><br>
            <code>L.esri.query(<span>&lt;<a href="../../api-reference/services/map-service.html">MapService</a>&gt;</span> <code>endpoint</code>)</code><br><br>
            <code>L.esri.query(<span>&lt;<a href="../../api-reference/services/image-service.html">ImageService</a>&gt;</span> <code>endpoint</code>)</code>
            </td>
            <td>Accepts either an <code>options</code> object or an instance of <a href="../..//api-reference/services/map-service.html">MapService</a>, <a href="../..//api-reference/services/feature-layer-service.html">FeatureLayerService</a> or <a href="../..//api-reference/services/image-service.html">ImageService</a>.</td>
        </tr>
    </tbody>
</table>

<h3 id="options">Options</h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url</code></td>
<td><code>String</code></td>
<td><code>&#39;&#39;</code></td>
<td>URL of the ArcGIS Server or ArcGIS Online service you would like to consume.</td>
</tr>
<tr>
<td><code>proxy</code></td>
<td><code>String</code></td>
<td><code>false</code></td>
<td>URL of an <a href="https://developers.arcgis.com/javascript/jshelp/ags_proxy.html">ArcGIS API for JavaScript proxy</a> or <a href="https://github.com/Esri/resource-proxy">ArcGIS Resource Proxy</a> to use for proxying POST requests.</td>
</tr>
<tr>
<td><code>useCors</code></td>
<td><code>Boolean</code></td>
<td><code>true</code></td>
<td>If this task should use CORS when making GET requests.</td>
</tr>
</tbody>
</table>
<h3 id="methods">Methods</h3>
<table>
    <thead>
        <tr>
            <th>Method</th>
            <th>Returns</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>within(<span>&lt;Geometry&gt;</span> <code>geometry</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features from the service within (fully contained by) the passed geometry object. <code>geometry</code> can be an instance of <a href="https://leafletjs.com/reference.html#marker"><code>L.Marker</code></a>, <a href="https://leafletjs.com/reference.html#polygon"><code>L.Polygon</code></a>, <a href="https://leafletjs.com/reference.html#polyline"><code>L.Polyline</code></a>, <a href="https://leafletjs.com/reference.html#latlng"><code>L.LatLng</code></a>, <a href="https://leafletjs.com/reference.html#latlngbounds"><code>L.LatLngBounds</code></a> and <a href="https://leafletjs.com/reference.html#geojson"><code>L.GeoJSON</code></a>. It can also accept valid GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2">Point</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.4">Polyline</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.6">Polygon</a> objects and GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.2">Feature objects</a> containing Point, Polyline, Polygon.</td>
        </tr>
        <tr>
            <td><code>contains(<span>&lt;Geometry&gt;</span> <code>geometry</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features from the service that fully contain the passed geometry object. <code>geometry</code> can be an instance of <a href="https://leafletjs.com/reference.html#marker"><code>L.Marker</code></a>, <a href="https://leafletjs.com/reference.html#polygon"><code>L.Polygon</code></a>, <a href="https://leafletjs.com/reference.html#polyline"><code>L.Polyline</code></a>, <a href="https://leafletjs.com/reference.html#latlng"><code>L.LatLng</code></a>, <a href="https://leafletjs.com/reference.html#latlngbounds"><code>L.LatLngBounds</code></a> and <a href="https://leafletjs.com/reference.html#geojson"><code>L.GeoJSON</code></a>. It can also accept valid GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2">Point</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.4">Polyline</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.6">Polygon</a> objects and GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.2">Feature objects</a> containing Point, Polyline, Polygon.</td>
        </tr>
        <tr>
            <td><code>intersects(<span>&lt;Geometry&gt;</span> <code>geometry</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features from the service that intersect (touch anywhere) the passed geometry object. <code>geometry</code> can be an instance of <a href="https://leafletjs.com/reference.html#marker"><code>L.Marker</code></a>, <a href="https://leafletjs.com/reference.html#polygon"><code>L.Polygon</code></a>, <a href="https://leafletjs.com/reference.html#polyline"><code>L.Polyline</code></a>, <a href="https://leafletjs.com/reference.html#latlng"><code>L.LatLng</code></a>, <a href="https://leafletjs.com/reference.html#latlngbounds"><code>L.LatLngBounds</code></a> and <a href="https://leafletjs.com/reference.html#geojson"><code>L.GeoJSON</code></a>. It can also accept valid GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2">Point</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.4">Polyline</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.6">Polygon</a> objects and GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.2">Feature objects</a> containing Point, Polyline, Polygon.</td>
        </tr>
        <tr>
            <td><code>bboxIntersects(<span>&lt;Geometry&gt;</span> <code>geometry</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features from the service that have a bounding box that intersects the bounding box of the passed geometry object. <code>geometry</code> can be an instance of <a href="https://leafletjs.com/reference.html#marker"><code>L.Marker</code></a>, <a href="https://leafletjs.com/reference.html#polygon"><code>L.Polygon</code></a>, <a href="https://leafletjs.com/reference.html#polyline"><code>L.Polyline</code></a>, <a href="https://leafletjs.com/reference.html#latlng"><code>L.LatLng</code></a>, <a href="https://leafletjs.com/reference.html#latlngbounds"><code>L.LatLngBounds</code></a> and <a href="https://leafletjs.com/reference.html#geojson"><code>L.GeoJSON</code></a>. It can also accept valid GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2">Point</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.4">Polyline</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.6">Polygon</a> objects and GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.2">Feature objects</a> containing Point, Polyline, Polygon.</td>
        </tr>
        <tr>
            <td><code>overlaps(<span>&lt;Geometry&gt;</span> <code>geometry</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features from the service that overlap (touch but are not fully contained by) the passed geometry object. <code>geometry</code> can be an instance of <a href="https://leafletjs.com/reference.html#marker"><code>L.Marker</code></a>, <a href="https://leafletjs.com/reference.html#polygon"><code>L.Polygon</code></a>, <a href="https://leafletjs.com/reference.html#polyline"><code>L.Polyline</code></a>, <a href="https://leafletjs.com/reference.html#latlng"><code>L.LatLng</code></a>, <a href="https://leafletjs.com/reference.html#latlngbounds"><code>L.LatLngBounds</code></a> and <a href="https://leafletjs.com/reference.html#geojson"><code>L.GeoJSON</code></a>. It can also accept valid GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2">Point</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.4">Polyline</a>, <a href="https://tools.ietf.org/html/rfc7946#section-3.1.6">Polygon</a> objects and GeoJSON <a href="https://tools.ietf.org/html/rfc7946#section-3.2">Feature objects</a> containing Point, Polyline, Polygon.</td>
        </tr>
        <tr>
            <td><code>nearby(<span>&lt;<a href="https://leafletjs.com/reference.html#latlng">LatLng</a>&gt;</span> <code>latlng</code>, <span>&lt;Integer&gt;</span> <code>distance</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features a given distance in meters around a <a href="https://leafletjs.com/reference.html#latlng">LatLng</a>. <br><small>Only available for Feature Layers hosted on ArcGIS Online or ArcGIS Server 10.3+ that include the capability <code>supportsQueryWithDistance</code>.</small></td>
        </tr>
        <tr>
            <td><code>where(<span>&lt;String&gt;</span> <code>where</code>)</code></td>
            <td><code>this</code></td>
            <td>Adds a <code>where</code> clause to the query.  String values should be denoted using single quotes ie: <code>query.where(&quot;FIELDNAME = &#39;field value&#39;&quot;);</code> More info about valid SQL can be found <a href="https://desktop.arcgis.com/en/arcmap/latest/map/working-with-layers/sql-reference-for-query-expressions-used-in-arcgis.htm">here</a>.</td>
        </tr>
        <tr>
            <td><code>offset(<span>&lt;Integer&gt;</span> <code>offset</code>)</code></td>
            <td><code>this</code></td>
            <td>Define the offset of the results, when combined with <code>limit</code> can be used for paging. <br><small>Only available for Feature Layers hosted on ArcGIS Online or ArcGIS Server 10.3+.</small></td>
        </tr>
        <tr>
            <td><code>limit(<span>&lt;Integer&gt;</span> <code>limit</code>)</code></td>
            <td><code>this</code></td>
            <td>Limit the number of results returned by this query, when combined with <code>offset</code> can be used for paging. <br><small>Only available for Feature Layers hosted on ArcGIS Online or ArcGIS Server 10.3.</small></td>
        </tr>
        <tr>
            <td><code>between(<span>&lt;Date&gt;</span> <code>from</code>, <span>&lt;Date&gt;</span> <code>to</code>)</code></td>
            <td><code>this</code></td>
            <td>Queries features within a given time range. <small>Only available for Layers/Services with <code>timeInfo</code> in their metadata.</small></td>
        </tr>
        <tr>
            <td><code>fields(<span>&lt;Array&gt;</span> <code>fields</code> or <span>&lt;String&gt;</span> <code>fields</code>)</code></td>
            <td><code>this</code></td>
            <td>An array of associated fields to request for each feature.</td>
        </tr>
        <tr>
            <td><code>returnGeometry(<span>&lt;Boolean&gt;</span> <code>returnGeometry</code>)</code></td>
            <td><code>this</code></td>
            <td>Return geometry with results. Default is <code>true</code>.</td>
        </tr>
        <tr>
            <td><code>simplify(<span>&lt;<a href="https://leafletjs.com/reference.html#map">Map</a>&gt;</span> <code>map</code>,  <span>&lt;Number&gt;</span> <code>factor</code>)</code></td>
            <td><code>this</code></td>
            <td>Simplify the geometries of the output features for the current map view. the <code>factor</code> parameter controls the amount of simplification between 0 (no simplification) and 1 (the most basic shape possible).</td>
        </tr>
        <tr>
            <td><code>orderBy(<span>&lt;String&gt;</span> <code>fieldName</code>, <span>&lt;String&gt;</span> <code>order</code>)</code></td>
            <td><code>this</code></td>
            <td>Sort output features using values from an individual field. <code>&quot;ASC&quot;</code> (ascending) is the default sort order, but <code>&quot;DESC&quot;</code> can be passed as an alternative.  This method can be called more than once to apply advanced sorting.</td>
        </tr>
        <tr>
            <td><code>featureIds(<span>&lt;Array&gt;</span> <code>ids</code>)</code></td>
            <td><code>this</code></td>
            <td>Return only specific feature IDs if they match other query parameters.</td>
        </tr>
        <tr>
            <td><code>precision(<span>&lt;Integer&gt;</span> <code>precision</code>)</code></td>
            <td><code>this</code></td>
            <td>Return only this many decimal points of precision in the output geometries.</td>
        </tr>
        <tr>
            <td><code>token(<span>&lt;String&gt;</span> <code>token</code>)</code></td>
            <td><code>this</code></td>
            <td>Adds a token to this request if the service requires authentication. Will be added automatically if used with a service.</td>
        </tr>
        <tr>
            <td><code>layer(<span>&lt;String or Integer&gt;</span> <code>layer</code>)</code></td>
            <td><code>this</code></td>
            <td>Used to select which layer inside a Map Service to perform the query on. <br><small>Only available for Map Services.</small></td>
        </tr>
        <tr>
            <td><code>pixelSize(<span>&lt;<a href="https://leafletjs.com/reference.html#point">Point</a>&gt;</span> <code>point</code>)</code></td>
            <td><code>this</code></td>
            <td>Override the default pixelSize when querying an Image Service. <br><small>Only available for Image Services.</small></td>
        </tr>
        <tr>
            <td><code>transform(<span>&lt;Number&gt;</span> <code>Number</code>)</code></td>
            <td><code>this</code></td>
            <td>The WKID of a <a href="https://developers.arcgis.com/rest/services-reference/datum-transformations.htm">datum transformation</a> for the server to apply when reprojecting output features.<br><small>Only available for ArcGIS Server 10.5+.</small></td>
        </tr>
        <tr>
            <td><code>distinct()</code></td>
            <td><code>this</code></td>
            <td>Ensures that no geometry or duplicate field values will be returned in the subsequent request.</td>
        </tr>
        <tr>
            <td><code>returnM(<span>&lt;Boolean&gt;</span> <code>returnM</code>)</code></td>
            <td><code>this</code></td>
            <td>Return geometry with four dimensional measure values in results.</td>
        </tr>
        <tr>
            <td><code>run(<span>&lt;Function&gt;</span> <code>callback</code>, <span>&lt;Object&gt;</span> <code>context</code>)</code></td>
            <td><code>this</code></td>
            <td>Executes the query request with the current parameters, features will be passed to <code>callback</code> as a <a href="https://tools.ietf.org/html/rfc7946#section-3.3">GeoJSON FeatureCollection</a>. Accepts an optional function context.</td>
        </tr>
        <tr>
            <td><code>count(<span>&lt;Function&gt;</span> <code>callback</code>, <span>&lt;Object&gt;</span> <code>context</code>)</code></td>
            <td><code>this</code></td>
            <td>Executes the query request with the current parameters, passing only the number of features matching the query to callback as an <code>Integer</code>. Accepts an optional function context.</td>
        </tr>
        <tr>
            <td><code>ids(<span>&lt;Function&gt;</span> <code>callback</code>, <span>&lt;Object&gt;</span> <code>context</code>)</code></td>
            <td><code>this</code></td>
            <td>Executes the query request with the current parameters, passing only an array of the feature ids matching the query to callback<code>callback</code>. Accepts an optional function context.</td>
        </tr>
        <tr>
            <td><code>bounds(<span>&lt;Function&gt;</span> <code>callback</code>, <span>&lt;Object&gt;</span> <code>context</code>)</code></td>
            <td><code>this</code></td>
            <td>Executes the query request with the current parameters, passing only the <a href="https://leafletjs.com/reference.html#latlngbounds"><code>LatLngBounds</code></a> of all features matching the query in the <code>callback</code>. Accepts an optional function context.  <small>Only available for Feature Layers hosted on ArcGIS Online or ArcGIS Server 10.3.1.</small></td>
        </tr>
    </tbody>
</table>

<h3 id="examples">Examples</h3>
<h5 id="finding-features-with-map-bounds">Finding features with map bounds</h5>
<pre><code class="language-js"><span class="keyword">var</span> southWest = L.latLng(<span class="number">45.51</span>, -<span class="number">122.70</span>);
<span class="keyword">var</span> northEast = L.latLng(<span class="number">45.52</span>, -<span class="number">122.64</span>);
<span class="keyword">var</span> bounds = L.latLngBounds(southWest, northEast);

<span class="keyword">var</span> query = L.esri.query({
  url: <span class="string">'https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/stops/FeatureServer/0'</span>
});

query.within(bounds);

query.run(<span class="function"><span class="keyword">function</span> <span class="params">(error, featureCollection, response)</span> {</span>
  <span class="keyword">if</span> (error) {
    console.log(error);
    <span class="keyword">return</span>;
  }
  console.log(<span class="string">'Found '</span> + featureCollection.features.length + <span class="string">' features'</span>);
});</code></pre>
<h5 id="finding-the-bounds-of-all-features">Finding the bounds of all features</h5>
<pre><code class="language-js"><span class="keyword">var</span> map = L.map(<span class="string">'map'</span>).setView([<span class="number">41.64</span>, -<span class="number">53.70</span>], <span class="number">3</span>);
L.esri.basemapLayer(<span class="string">'Gray'</span>).addTo(map);

<span class="keyword">var</span> query = L.esri.query({
  url: <span class="string">'https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/stops/FeatureServer/0'</span>
});

query.bounds(<span class="function"><span class="keyword">function</span> <span class="params">(error, latLngBounds, response)</span> {</span>
  <span class="keyword">if</span> (error) {
    console.log(error);
    <span class="keyword">return</span>;
  }
  map.fitBounds(latLngBounds);
});</code></pre>
<h5 id="querying-features-near-a-latlng">Querying features near a latlng</h5>
<pre><code class="language-js"><span class="keyword">var</span> latlng = L.latLng(<span class="number">45.51</span>, -<span class="number">122.70</span>);

<span class="keyword">var</span> query = L.esri.query({
  url: <span class="string">'https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/stops/FeatureServer/0'</span>
});

query.nearby(latlng, <span class="number">500</span>);

query.run(<span class="function"><span class="keyword">function</span> <span class="params">(error, featureCollection, response)</span> {</span>
  <span class="keyword">if</span> (error) {
    console.log(error);
    <span class="keyword">return</span>;
  }
  console.log(<span class="string">'Found '</span> + featureCollection.features.length + <span class="string">' features'</span>);
});</code></pre>
<h5 id="combining-multiple-options">Combining multiple options</h5>
<pre><code class="language-js"><span class="keyword">var</span> latlng = L.latLng(<span class="number">45.51</span>, -<span class="number">122.70</span>);

<span class="keyword">var</span> query = L.esri.query({
  url: <span class="string">'https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/stops/FeatureServer/0'</span>
});

query.nearby(latlng, <span class="number">2000</span>).where(<span class="string">"direction='East'"</span>).orderBy(<span class="string">'stop_id'</span>, <span class="string">'ASC'</span>);

query.count(<span class="function"><span class="keyword">function</span> <span class="params">(error, count, response)</span> {</span>
  <span class="keyword">if</span> (error) {
    console.log(error);
    <span class="keyword">return</span>;
  }
  console.log(<span class="string">'Found '</span> + count + <span class="string">' features'</span>);
});

query.ids(<span class="function"><span class="keyword">function</span> <span class="params">(error, ids, response)</span> {</span>
  <span class="keyword">if</span> (error) {
    console.log(error);
    <span class="keyword">return</span>;
  }
  console.log(ids.join(<span class="string">', '</span>) + <span class="string">'match the provided parameters'</span>);
});</code></pre>
<h5 id="getting-the-bounds-of-the-query-result">Getting the bounds of the query result</h5>
<pre><code class="language-js"><span class="keyword">var</span> map = L.map(<span class="string">'map'</span>).setView([<span class="number">41.64</span>, -<span class="number">53.70</span>], <span class="number">3</span>);
L.esri.basemapLayer(<span class="string">'Gray'</span>).addTo(map);

<span class="keyword">var</span> query = L.esri.query({
  url: <span class="string">'https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/stops/FeatureServer/0'</span>
});

query.where(<span class="string">"zone_id='B'"</span>).bounds(<span class="function"><span class="keyword">function</span> <span class="params">(error, latLngBounds, response)</span> {</span>
  <span class="keyword">if</span> (error) {
    console.log(error);
    <span class="keyword">return</span>;
  }
  map.fitBounds(latLngBounds);
});</code></pre>

  <p><a href="https://github.com/Esri/esri-leaflet-doc/edit/master/src/pages/api-reference/tasks/query.md">Edit this page on GitHub</a></p>

  <div class="mobile-menu">
    <aside class="sidebar">
  <h5>Layers</h5>
  <nav>
    <a class="plugin" href="../../api-reference/layers/vector-basemap.html">Vector Basemap Layer</a>
    <a class="plugin" href="../../api-reference/layers/cluster-feature-layer.html">Cluster Feature Layer</a>
    <a href="../../api-reference/layers/dynamic-map-layer.html">Dynamic Map Layer</a>
    <a href="../../api-reference/layers/feature-layer.html">Feature Layer</a>
    <a class="plugin" href="../../api-reference/layers/heatmap-feature-layer.html">Heatmap Feature Layer</a>
    <a href="../../api-reference/layers/image-map-layer.html">Image Map Layer</a>
    <a href="../../api-reference/layers/tiled-map-layer.html">Tiled Map Layer</a>
    <a class="plugin" href="../../api-reference/layers/vector-layer.html">Vector Layer</a>
  </nav>

  <h5>Controls</h5>
  <nav>
    <a class="plugin" href="../../api-reference/controls/geosearch.html" class="plugin">Geosearch</a>
  </nav>

  <h5>Tasks</h5>
  <nav>
    <a href="../../api-reference/tasks/find.html">Find</a>
    <a class="plugin" href="../../api-reference/tasks/geocode.html">Geocode</a>
    <a class="plugin" href="../../api-reference/tasks/reverse-geocode.html">Reverse Geocode</a>
    <a class="plugin" href="../../api-reference/tasks/suggest.html">Suggest</a>
    <a class="plugin" href="../../api-reference/tasks/gp.html">Geoprocessing Task</a>
    <a href="../../api-reference/tasks/identify-features.html">Identify Features</a>
    <a href="../../api-reference/tasks/identify-image.html">Identify Image</a>
    <a href="../../api-reference/tasks/query.html">Query</a>
    <a class="plugin" href="../../api-reference/tasks/query-related.html">Query Related</a>
  </nav>

  <h5>Misc.</h5>
  <nav>
    <a href="../../api-reference/events.html">Events</a>
    <a href="../../api-reference/options.html">options</a>
    <a href="../../api-reference/request.html">request</a>
    <a href="../../api-reference/util.html">Util</a>
  </nav>

  <h5>Base Classes</h5>
  <nav>
    <a href="../../api-reference/services/feature-layer-service.html">FeatureLayerService</a>
    <a class="plugin" href="../../api-reference/services/geocode-service.html">Geocode Service</a>
    <a class="plugin" href="../../api-reference/services/gp-service.html">Geoprocessing Service</a>
    <a href="../../api-reference/services/image-service.html">ImageService</a>
    <a href="../../api-reference/services/map-service.html">MapService</a>
    <a href="../../api-reference/layers/raster-layer.html">Raster Layer</a>
    <a href="../../api-reference/services/service.html">Service</a>
    <a href="../../api-reference/tasks/task.html">Task</a>
  </nav>

  <h5>Deprecated</h5>
  <nav>
    <a class="deprecated" href="../../api-reference/layers/basemap-layer.html">Basemap Layer</a>
  </nav>

</aside>

  </div>
</div>

  <div style="clear:both;"></div>
</div>

  <div class="container center-text">
    <p class="copyright"><a href="https://github.com/esri/esri-leaflet#terms">Terms</a></p>
  </div>
  <script src="../../js/script.js"></script>
  </body>
</html>